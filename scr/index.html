<!-- หน้าหลักของ Web App (Single Page Application) -->
<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ระบบเรียกคิวออนไลน์</title> <!-- หัวข้อหน้าเว็บ -->
  <script src="https://cdn.tailwindcss.com"></script> <!-- Tailwind CSS Framework -->
  <style>
    <?!= include('css/base-styles'); ?> /* Inject base rules first */

    <? var themeName = activeTheme || 'standard'; ?>
    <? if (themeName === 'pastel') { ?>
          <?!= include('css/theme-pastel'); ?>
    <? } else if (themeName === 'nature') { ?>
          <?!= include('css/theme-nature'); ?>
    <? } else if (themeName === 'aurora') { ?>
          <?!= include('css/theme-aurora'); ?>
    <? } else if (themeName === 'oceanic') { ?>
          <?!= include('css/theme-oceanic'); ?>
    <? } else if (themeName === 'neontech') { ?>
          <?!= include('css/theme-neontech'); ?>
    <? } else if (themeName === 'neontech-light') { ?>
          <?!= include('css/theme-neontech-light'); ?>
    <? } else if (themeName === 'sunset') { ?>
          <?!= include('css/theme-sunset'); ?>
    <? } else { /* Default to standard or if themeName is 'standard' */ ?>
          <?!= include('css/theme-standard'); ?>
    <? } ?>
  </style>
</head>
<!-- ส่วน Body ของหน้าเว็บ -->
<body class="font-sans <? if (activeTheme) { ?>theme-<?= activeTheme ?><? } else { ?>theme-standard<? } ?>"> <!-- Add theme class to body -->
  <!-- Container หลักของ Application -->
  <div id="app"> 
    <!-- Login Form: ส่วนฟอร์มสำหรับเข้าสู่ระบบ -->
    <div id="loginForm" class="min-h-screen flex items-center justify-center px-4 hidden"> 
      <div class="theme-login-card rounded-xl p-8 md:p-10 w-full max-w-md"> <!-- Changed to theme-login-card -->
        <h1 class="text-3xl font-bold text-center text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-violet-600 mb-8">
          ระบบเรียกคิวออนไลน์
        </h1> <!-- หัวข้อฟอร์ม Login -->
        <div class="mb-6">
          <label class="block text-gray-700 text-sm font-semibold mb-2" for="username">ชื่อผู้ใช้</label>
          <input id="username" type="text" class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-shadow">
        </div>
        <div class="mb-8">
          <label class="block text-gray-700 text-sm font-semibold mb-2" for="password">รหัสผ่าน</label>
          <input id="password" type="password" class="shadow-sm appearance-none border border-gray-300 rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-shadow">
        </div>
        <div class="flex items-center justify-between">
          <button id="loginBtn" class="theme-button-primary w-full font-bold py-3 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-all duration-300 ease-in-out transform hover:scale-105 shadow-lg">
            เข้าสู่ระบบ
          </button>
        </div>
        <div id="loginError" class="text-red-600 bg-red-100 border border-red-400 p-3 rounded-md text-center mt-6 hidden"></div>
      </div>
    </div>

    <!-- Dashboard: ส่วนแสดงผลหลักหลังจากการ Login -->
    <div id="dashboard" class="container mx-auto px-4 py-8 max-w-6xl hidden">
      <div class="theme-card rounded-xl shadow-2xl p-6 md:p-8">
        <!-- ส่วนหัวของ Dashboard: แสดงชื่อผู้ใช้ และปุ่ม Logout -->
        <div class="flex justify-between items-center mb-6">
          <h1 class="text-3xl font-bold theme-title-gradient">Dashboard</h1>
          <div class="flex items-center">
            <span id="userInfo" class="mr-4 theme-text-default"></span>
            <button id="logoutBtn" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-lg shadow hover:shadow-md transition-all"> <!-- This button can have its own specific style or a theme-secondary-button class -->
              ออกจากระบบ
            </button> <!-- ปุ่มออกจากระบบ -->
          </div>
        </div>

        <!-- Grid แสดงเมนูหลักของ Dashboard -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Card: จองคิว -->
          <div class="theme-dashboard-card theme-dashboard-card-1">
            <h2 class="text-2xl font-semibold mb-3">จองคิว</h2>
            <p class="mb-4">สำหรับผู้ใช้บริการจองคิวใหม่</p>
            <button id="userPageBtn" class="theme-dashboard-card-button">
              เข้าสู่หน้าจองคิว
            </button> <!-- ปุ่มไปหน้าจองคิว -->
          </div>
          <!-- Card: แสดงผลคิว -->
          <div class="theme-dashboard-card theme-dashboard-card-2">
            <h2 class="text-2xl font-semibold mb-3">แสดงผลคิว</h2>
            <p class="mb-4">แสดงหน้าจอสำหรับผู้รอคิว</p>
            <button id="displayPageBtn" class="theme-dashboard-card-button">
              เข้าสู่หน้าแสดงผล
            </button> <!-- ปุ่มไปหน้าแสดงผลคิว -->
          </div>
          <!-- Card: แอดมิน (แสดงเฉพาะ admin) -->
          <div id="adminPanel" class="theme-dashboard-card theme-dashboard-card-3">
            <h2 class="text-2xl font-semibold mb-3">แอดมิน</h2>
            <p class="mb-4">จัดการระบบเรียกคิว</p>
            <button id="adminPageBtn" class="theme-dashboard-card-button">
              เข้าสู่หน้าแอดมิน
            </button> <!-- ปุ่มไปหน้าแอดมิน -->
          </div>
          <!-- Card: ตั้งค่าระบบ -->
          <div class="theme-dashboard-card theme-dashboard-card-4">
            <h2 class="text-2xl font-semibold mb-3">ตั้งค่าระบบ</h2>
            <p class="mb-4">ตั้งค่าพื้นฐานของระบบ</p>
            <button id="settingsPageBtn" class="theme-dashboard-card-button">
              เข้าสู่หน้าตั้งค่า
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- SPA Sections: ส่วนต่างๆ ที่จะแสดงผลภายในหน้า index.html (Single Page Application) -->
    <div id="userSection" class="container mx-auto px-4 py-8 hidden">
      <div class="theme-card rounded-xl shadow-2xl p-6 md:p-8">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold theme-title-gradient">หน้าจองคิว</h2>
        </div>

        <p>การจองคิวจะเปิดในหน้าต่างใหม่เมื่อคลิกปุ่มจากหน้าหลัก</p>
        <!-- ปุ่มกลับหน้าหลัก และ Logout (ถ้าจำเป็น) -->
         <button class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg mt-4" onclick="showSection('dashboard')">กลับหน้าหลัก</button>
         <button id="logoutBtnUser" class="mt-4 bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-4 rounded-lg">
            ออกจากระบบ
          </button>
      </div> <!-- ปิด userSection card -->
    </div>

    <div id="displaySection" class="container mx-auto px-4 py-8 hidden">
      <div class="theme-card rounded-xl shadow-2xl p-6 md:p-8">
        <h2 class="text-2xl font-bold theme-title-gradient mb-4">หน้าแสดงผลคิว</h2>
        <button class="mt-4 bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg" onclick="showSection('dashboard')">กลับหน้าหลัก</button>

      </div> <!-- ปิด displaySection card -->
    </div>

    <div id="adminSection" class="container mx-auto px-4 py-8 max-w-6xl hidden"> <!-- max-w-4xl removed to allow admin content to be wider -->
      <div class="theme-card rounded-xl shadow-2xl p-6 md:p-8">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold theme-title-gradient">หน้าแอดมิน</h2>
          <button class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg" onclick="showSection('dashboard')">กลับหน้าหลัก</button> <!-- ปุ่มกลับหน้า Dashboard -->
        </div>
        <!-- Include เนื้อหาของหน้า Admin จากไฟล์ admin.html -->
        <?!= include('admin'); ?>
      </div> <!-- ปิด adminSection card -->
    </div>

     <div id="settingsSection" class="container mx-auto px-4 py-8 max-w-6xl hidden"> <!-- max-w-4xl removed to allow settings content to be wider -->
      <div class="theme-card rounded-xl shadow-2xl p-6 md:p-8">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-2xl font-bold theme-title-gradient">ตั้งค่าระบบ</h2>
          <button class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg" onclick="showSection('dashboard')">กลับหน้าหลัก</button> <!-- ปุ่มกลับหน้า Dashboard -->
         </div>
        <!-- Include เนื้อหาของหน้า Settings จากไฟล์ settings.html -->
        <?!= include('settings'); ?>
      </div> <!-- ปิด settingsSection card -->
    </div>

     <!-- Footer: ส่วนท้ายของหน้าเว็บ -->
    <footer class="theme-footer text-center py-6 mt-12">
      <div class="container mx-auto px-4">
        <p class="text-sm">
          Copyright © โรงพยาบาลส่งเสริมสุขภาพตำบลบ้านหาร
        </p> <!-- ข้อความลิขสิทธิ์ -->
      </div>
    </footer>

  </div> <!-- Closing div for id="app" -->

    <!-- Add Slideshow Image Modal -->
    <div id="addSlideshowImageModal" class="fixed z-20 inset-0 overflow-y-auto hidden" aria-labelledby="addSlideshowImageModalTitle" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10">
                            <svg class="h-6 w-6 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6a9 9 0 01-9-9V4a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1V4a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1V4a1 1 0 011-1h2a1 1 0 011 1v7a9 9 0 01-9 9z" />
                            </svg>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900" id="addSlideshowImageModalTitle">เพิ่มรูปภาพสไลด์โชว์ใหม่</h3>
                            <div class="mt-4 space-y-4">
                                <div>
                                    <label for="newSlideshowImageUrl" class="block text-sm font-medium text-gray-700">URL รูปภาพ:</label>
                                    <input type="url" id="newSlideshowImageUrl" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="https://example.com/image.jpg">
                                </div>
                                <div>
                                    <label for="newSlideshowImageTitle" class="block text-sm font-medium text-gray-700">หัวข้อ (Title):</label>
                                    <input type="text" id="newSlideshowImageTitle" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="คำอธิบายรูปภาพ">
                                </div>
                                <div>
                                    <label for="newSlideshowImageOrder" class="block text-sm font-medium text-gray-700">ลำดับการแสดงผล:</label>
                                    <input type="number" id="newSlideshowImageOrder" min="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm" placeholder="0">
                                </div>
                                <div class="flex items-center">
                                    <input id="newSlideshowImageIsActive" type="checkbox" class="h-4 w-4 text-green-600 border-gray-300 rounded focus:ring-green-500" checked>
                                    <label for="newSlideshowImageIsActive" class="ml-2 block text-sm text-gray-900">ใช้งานรูปภาพนี้ (Is Active)</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="addSlideshowImageModalMessage" class="px-6 py-2 text-sm"></div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="saveNewSlideshowImageBtn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm">
                        บันทึก
                    </button>
                    <button type="button" id="cancelNewSlideshowImageBtn" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        ยกเลิก
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Slideshow Image Modal -->
    <div id="editSlideshowImageModal" class="fixed z-20 inset-0 overflow-y-auto hidden" aria-labelledby="editSlideshowImageModalTitle" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                         <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10">
                            <svg class="h-6 w-6 text-yellow-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                            </svg>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900" id="editSlideshowImageModalTitle">แก้ไขรูปภาพสไลด์โชว์</h3>
                            <input type="hidden" id="editSlideshowImageId">
                            <div class="mt-4 space-y-4">
                                <div>
                                    <label for="editSlideshowImageUrl" class="block text-sm font-medium text-gray-700">URL รูปภาพ:</label>
                                    <input type="url" id="editSlideshowImageUrl" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                                </div>
                                <div>
                                    <label for="editSlideshowImageTitle" class="block text-sm font-medium text-gray-700">หัวข้อ (Title):</label>
                                    <input type="text" id="editSlideshowImageTitle" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                                </div>
                                <div>
                                    <label for="editSlideshowImageOrder" class="block text-sm font-medium text-gray-700">ลำดับการแสดงผล:</label>
                                    <input type="number" id="editSlideshowImageOrder" min="0" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-yellow-500 focus:border-yellow-500 sm:text-sm">
                                </div>
                                <div class="flex items-center">
                                    <input id="editSlideshowImageIsActive" type="checkbox" class="h-4 w-4 text-yellow-600 border-gray-300 rounded focus:ring-yellow-500">
                                    <label for="editSlideshowImageIsActive" class="ml-2 block text-sm text-gray-900">ใช้งานรูปภาพนี้ (Is Active)</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="editSlideshowImageModalMessage" class="px-6 py-2 text-sm"></div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="saveEditSlideshowImageBtn" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-yellow-500 text-base font-medium text-white hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-400 sm:ml-3 sm:w-auto sm:text-sm">
                        บันทึกการเปลี่ยนแปลง
                    </button>
                    <button type="button" id="cancelEditSlideshowImageBtn" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
                        ยกเลิก
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- View Slideshow Image Modal -->
    <div id="viewSlideshowImageModal" class="fixed z-20 inset-0 overflow-y-auto hidden" aria-labelledby="viewSlideshowImageModalTitle" role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen p-4 text-center">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
            <div class="inline-block bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl w-full p-4">
                <div class="flex justify-between items-center pb-3">
                    <h3 class="text-lg font-medium text-gray-900" id="viewSlideshowImageModalTitle">ดูรูปภาพ</h3>
                    <button type="button" id="closeViewSlideshowImageModalBtn" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                    </button>
                </div>
                <img id="viewSlideshowImagePreview" src="" alt="Image Preview" class="w-auto h-auto max-w-full max-h-[80vh] mx-auto">
                <p id="viewSlideshowImageCaption" class="text-center text-sm text-gray-600 mt-2"></p>
            </div>
        </div>
    </div>

  <?!= include('js/main'); ?>
  <?!= include('js/auth'); ?>
  <?!= include('js/user'); ?>
  <?!= include('js/admin'); ?>
  <?!= include('js/settings'); ?>

  <script>
    // Script สำหรับจัดการ Event Listener เมื่อ DOM โหลดเสร็จ
    // ตรวจสอบว่ามี element หรือไม่ก่อนผูก event
    document.addEventListener('DOMContentLoaded', function() {
      // ผูก Event กับปุ่ม Logout ใน userSection (ถ้ามี)
      // Ensure logout button in userSection also works if it's different from the main one
      const logoutBtnUser = document.getElementById('logoutBtnUser');
      if (logoutBtnUser && typeof handleLogout === 'function') {
        logoutBtnUser.addEventListener('click', handleLogout);
      }
       // Other initializations if needed
    });

  </script>
</body>
</html>
